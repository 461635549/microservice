<?xml version="1.0" encoding="UTF-8"?>

<root>
  <parseRule>
    <ruleName>H3C_WAF_SecPathW2020-G_3.10_WebAttack_syslog</ruleName>
    <logType>web_attack</logType>
    <ruleType>1</ruleType>
    <subType>10</subType>
    <pluginName/>
    <pluginUse></pluginUse>
    <filter>false</filter>
    <filterType>0</filterType>
    <filterContent></filterContent>
    <description></description>
    <ruleData>
      <regex>(?&lt;occur_time&gt;\d+\-\d+\-\d+\s+\d+\:\d+\:\d+)[^\=\n]*\=(?&lt;dev_name&gt;[^\s]*)\s*sp_attack[^\=\n]*\=(?&lt;sip&gt;[^\s]*)[^\=\n]*\=(?&lt;dip&gt;[^\s]*)[^\=\n]*\=(?&lt;url&gt;[^\s]*)[^\=\n]*\=(?&lt;attack_type&gt;[^\s]*)[^\=\n]*\=(?&lt;action&gt;[^\s]*)[^\=\n]*\=(?&lt;http_method&gt;.*)</regex>
      <hasDoubleQuotes>false</hasDoubleQuotes>
      <fields>
		<field>
          <isExtract>true</isExtract>
          <srcName>occur_time</srcName>
          <srcType>string(yyyy-MM-dd HH:mm:ss)</srcType>
          <destName>occur_time</destName>
          <destType>date</destType>
          <destAlias>发生时间</destAlias>
          <isTimeField>true</isTimeField>
          <example>2020-04-21 16:18:29</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>dev_name</srcName>
          <srcType>string</srcType>
          <destName>dev_name</destName>
          <destType>string</destType>
          <destAlias>设备名称</destAlias>
          <isTimeField>false</isTimeField>
          <example>H3C</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>sip</srcName>
          <srcType>string</srcType>
          <destName>sip</destName>
          <destType>ip</destType>
          <destAlias>源IP</destAlias>
          <isTimeField>false</isTimeField>
          <example>10.111.21.117</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>dip</srcName>
          <srcType>string</srcType>
          <destName>dip</destName>
          <destType>ip</destType>
          <destAlias>目的IP</destAlias>
          <isTimeField>false</isTimeField>
          <example>10.111.21.183</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>url</srcName>
          <srcType>string</srcType>
          <destName>url</destName>
          <destType>string</destType>
          <destAlias>URL</destAlias>
          <isTimeField>false</isTimeField>
          <example>10.111.21.138/platformjpush/phone/jpush/push</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>attack_type</srcName>
          <srcType>string</srcType>
          <destName>attack_type</destName>
          <destType>string</destType>
          <destAlias>攻击类型</destAlias>
          <isTimeField>false</isTimeField>
          <example>Oversize</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>action</srcName>
          <srcType>string</srcType>
          <destName>action</destName>
          <destType>string</destType>
          <destAlias>动作</destAlias>
          <isTimeField>false</isTimeField>
          <example>detected</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>true</isExtract>
          <srcName>http_method</srcName>
          <srcType>string</srcType>
          <destName>http_method</destName>
          <destType>string</destType>
          <destAlias>HTTP请求方法</destAlias>
          <isTimeField>false</isTimeField>
          <example>GET</example>
          <assignment></assignment>
        </field>
        <field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>msgid</destName>
          <destType>string</destType>
          <destAlias>日志ID</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>uuid</assignType>
            <value></value>
            <valueType></valueType>
          </assignment>
        </field>
        <field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>systype</destName>
          <destType>string</destType>
          <destAlias>数据业务类型</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>input</assignType>
            <value>log</value>
            <valueType>string</valueType>
          </assignment>
        </field>
        <field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>dev_type</destName>
          <destType>string</destType>
          <destAlias>数据源类型</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>input</assignType>
            <value>WAF</value>
            <valueType>string</valueType>
          </assignment>
        </field>
		<field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>dev_vendor</destName>
          <destType>string</destType>
          <destAlias>设备厂商</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>input</assignType>
            <value>华三</value>
            <valueType>string</valueType>
          </assignment>
        </field>
        <field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>dev_version</destName>
          <destType>string</destType>
          <destAlias>设备版本</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>input</assignType>
            <value>SecPathW2020-G/3.10.R6713p02</value>
            <valueType>string</valueType>
          </assignment>
        </field>
        <field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>domain</destName>
          <destType>string</destType>
          <destAlias>域名</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>regex</assignType>
            <value>url</value>
            <valueType>string</valueType>
            <regex>(^[^\/]*)</regex>
          </assignment>
        </field>
        <field>
          <isExtract>false</isExtract>
          <srcName></srcName>
          <srcType></srcType>
          <destName>uri</destName>
          <destType>string</destType>
          <destAlias>URI资源</destAlias>
          <isTimeField>false</isTimeField>
          <assignment>
            <assignType>regex</assignType>
            <value>url</value>
            <valueType>string</valueType>
            <regex>(\/.*)</regex>
          </assignment>
        </field>
      </fields>
    </ruleData>
  </parseRule>
</root>
